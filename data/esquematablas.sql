--- Sentencias SQL para la creación del esquema de parranderos
--- Las tablas tienen prefijo A_ para facilitar su acceso desde SQL Developer

-- USO
-- Copie el contenido de este archivo en una pestaña SQL de SQL Developer
-- Ejecútelo como un script - Utilice el botón correspondiente de la pestaña utilizada

-- Creación del secuenciador
create sequence parranderos_sequence;

-- Creaación de la tabla AFILIADO y especificación de sus restricciones
CREATE TABLE AFILIADO
   (
    ID NUMBER, 
    ESTADOSALUD VARCHAR2 (255 BYTE), 
	  FECHANACIMIENTO DATE,
    RECETA VARCHAR2 (255 BYTE),
    IDORDEN NUMBER,
    IDUSUARIOAFILIADO NUMBER,
    IDEPS NUMBER, 
	  CONSTRAINT AFILIADO PRIMARY KEY (ID)
   );
	
ALTER TABLE AFILIADO
	ADD CONSTRAINT ID 
	CHECK (ID>0)
ENABLE;

ALTER TABLE AFILIADO
 ADD CONSTRAINT FK_ORDEN
   FOREIGN KEY (IDORDEN)
   REFERENCES ORDEN(ID)
   ENABLE; 

ALTER TABLE AFILIADO
 ADD CONSTRAINT FK_USUARIOAFILIADO
   FOREIGN KEY (IDUSUARIOAFILIADO)
   REFERENCES USUARIO(ID)
   ENABLE;

ALTER TABLE AFILIADO
ADD CONSTRAINT FK_IDEPS
FOREIGN KEY (IDEPS)
REFERENCES EPS(ID)
ENABLE;
-- Creaación de la tabla EPS y especificación de sus restricciones
CREATE TABLE EPS 
   (ID NUMBER, 
	NOMBRE VARCHAR2(255 BYTE), 
	IDGERENTE NUMBER, 
	CONSTRAINT EPS PRIMARY KEY (ID));
	
ALTER TABLE EPS
ADD CONSTRAINT FK_GERENTE
    FOREIGN KEY (IDGERENTE)
    REFERENCES GERENTE(id)
ENABLE;

-- Creaación de la tabla ORDEN y especificación de sus restricciones
CREATE TABLE ORDEN
   (ID NUMBER, 
	 IDSERVICIO NUMBER, 
	CONSTRAINT ORDEN PRIMARY KEY (ID));
	 
ALTER TABLE ORDEN
	ADD CONSTRAINT FK_ORDEN 
	FOREIGN KEY (IDSERVICIO)
  REFERENCES SERVICIO(ID)
ENABLE;

-- Creaación de la tabla GERENTE y especificación de sus restricciones
CREATE TABLE GERENTE
   (ID NUMBER, 
    IDGERENTEUSUARIO NUMBER, 
		CONSTRAINT GERENTE PRIMARY KEY (ID));

ALTER TABLE GERENTE
	ADD CONSTRAINT FK_USUARIO 
	FOREIGN KEY IDGERENTEUSUARIO
  REFERENCES USUARIO(ID)
ENABLE;

-- Creaación de la tabla USUARIO y especificación de sus restricciones
CREATE TABLE USUARIO
(
  ID NUMBER,
  EMAIL VARCHAR2 (255 BYTE),
  NOMBRE VARCHAR2 )(255 BYTE ),
  NUMERODOCUMENTO NUMBER (20,0),
  ROLID NUMBER,
  TIPODOCUMENTO VARCHAR2 (255 BYTE),
  CONSTRAINT USUARIO PRIMARY KEY (ID));

ALTER TABLE A_GUSTAN
ADD CONSTRAINT NNDOCUMENTO
    NOT NULL (NUMERODOCUMENTO)
  ENABLE;
    


-- Creaación de la tabla RECEPCIONISTA y especificación de sus restricciones
CREATE TABLE RECEPCIONISTA
(
  ID NUMBER,
  IDIPS NUMBER,
  IDUSUARIO NUMBER, 
  CONSTRAINT RECEPCIONISTA PRIMARY KEY (ID);

ALTER TABLE RECEPCIONISTA
ADD CONSTRAINT FK_IPS
    FOREIGN KEY (IDIPS)
    REFERENCES IPS(id)
ENABLE;
    
ALTER TABLE RECEPCIONISTA
ADD CONSTRAINT FK_USUARIO
    FOREIGN KEY (IDUSUARIO)
    REFERENCES USUARIO(id)
ENABLE;

-- Creaación de la tabla VISITAN y especificación de sus restricciones
CREATE TABLE MEDICO 
(
  ID NUMBER,
  ESPECIALIDAD VARCHAR2 (255 BYTE),
  NUMEROREGISTRO VARCHAR2(255 BYTE), 
  FECHAVISITA DATE,
  IDUSUARIO NUMBER, 
  CONSTRAINT MEDICO PRIMARY KEY (ID);

ALTER TABLE MEDICO
ADD CONSTRAINT FK_USUARIO
    FOREIGN KEY (IDUSUARIO)
    REFERENCES USUARIO(IDD)
ENABLE;
    
CREATE TABLE JOINMEDICOIPS
(
  IDMEDICO NUMBER,
  IDIPS IPS,
  CONSTRAINT MEDICO PRIMARY KEY (IDMEDICO,IDIPS);
);

ALTER TABLE JOINMEDICOIPS
ADD CONSTRAINT FK_MEDICO
    FOREIGN KEY (IDMEDICO)
    REFERENCES MEDICO(ID)
ENABLE;

ALER TABLE JOINMEDICOIPS
ADD CONSTRAINT FK_IPS
    FOREIGN KEY (IDIPS)
    REFERENCES IPS(ID)
    ENABLE;

CREATE TABLE SERVICIO 
(
  ID NUMBER,
  CAPACIDAD NUMBER,
  ESTADO VARCHAR2(255 BYTE),
  FECHA DATE 
  HORARIOS VARCHAR2(255 BYTE),
  IDSERVICIO NUMBER,
  IDAFILIADO NUMBER,
  IDIPS NUMBER,
  IDMEDICO NUMBER,
  CONSTRAINT SERVICIO PRIMARY KEY (ID)
);

ALTER TABLE SERVICIO 
ADD CONSTRAINT FK_IPS
    FOREIGN KEY (IDIPS)
    REFERENCES IPS(ID)
ENABLE;

ALTER TABLE SERVICIO 
ADD CONSTRAINT FK_MEDICO
    FOREIGN KEY (IDMEDICO)
    REFERENCES MEDICO(ID)
ENABLE;

ALTER TABLE SERVICIO 
ADD CONSTRAINT FK_AFILIADO
    FOREIGN KEY (IDAFILIADO)
    REFERENCES AFILIADO(ID)
ENABLE;

ALTER TABLE SERVICIO 
ADD CONSTRAINT FK_SERVICIO
    FOREIGN KEY (IDSERVICIO)
    REFERENCES SERVICIO(ID)
ENABLE;

CREATE TABLE EXAMENDIAGNOSTICO 
(
  IDSERVICIO NUMBER, 
  MUESTRA VARCHAR2 (255 BYTE),
  CONSTRAINT EXAMENDIAGNOSTICO PRIMARY KEY (IDSERVICIO)
);

ALTER TABLE EXAMENDIAGNOSTICO
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE; 

CREATE TABLE  HOSPITALIZACION 
(
  IDSERVICIO NUMBER,
  CONSTRAINT HOSPITALIZACION PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE HOSPITALIZACION
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE;

CREATE TABLE  CONSULTA 
(
  IDSERVICIO NUMBER,
  CONSTRAINT CONSULTA PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE CONSULTA
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE;

CREATE TABLE  CONTROL
(
  IDSERVICIO NUMBER,
  CONSTRAINT CONTROL PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE CONTROL
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE;

CREATE TABLE  REMISION 
(
  IDSERVICIO NUMBER,
  CONSTRAINT HOSPITALIZACION PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE REMISION
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE;

CREATE TABLE  HOSPITALIZACION 
(
  IDSERVICIO NUMBER,
  CONSTRAINT HOSPITALIZACION PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE HOSPITALIZACION
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE; 

CREATE TABLE  TERAPIA 
(
  IDSERVICIO NUMBER,
  CONSTRAINT TERAPIA PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE TERAPIA
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE;

 CREATE TABLE  URGENCIA
(
  IDSERVICIO NUMBER,
  CONSTRAINT URGENCIA PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE URGENCIA
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE; 

 CREATE TABLE  PROCEDIMIENTOESPECIALIZADO 
(
  IDSERVICIO NUMBER,
  CONSTRAINT PROCEDIMIENTOESPECIALIZADO PRIMARY KEY (IDSERVICIO)  
);

ALTER TABLE PROCEDIMIENTOESPECIALIZADO
ADD CONSTRAINT FK__SERVICIO
 FOREIGN KEY IDSERVICIO
 REFERENCES SERVICIO(ID)
 ENABLE; 




COMMIT;
