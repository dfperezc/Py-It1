--CONSULTA1

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0)  

INSERT INTO USUARIO (ID,EMAIL,NOMBRE,NUMERODOCUMENTO, ROL, TIPODOCUMENTO) 
VALUES ("","","",0 ,"",""); 

-- CONSULTA 2

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0)  

INSERT INTO USUARIO (ID,EMAIL,NOMBRE,NUMERODOCUMENTO, ROL, TIPODOCUMENTO) 
VALUES ("","","",0 ,"",""); 

-- DEPENDIENDO DEL ROL ENTRA A ALGUNO 

--medico
INSERT INTO MEDICO (ID,ESPECIALIDAD,NUMEROREGISTRO,FECHAVISITA,IDUSUARIO)
VALUES (0,"","",DATE,0);
--gerente
INSERT INTO GERENTE (ID ,IDGERENTEUSUARIO)
 VALUES (0,0);
--admin
INSERT INTO ADMINISTRADOR (ID,IDUSUARIO,IDIPS)
VALUES (0,0,0 );

--afiliado
INSERT INTO AFILIADO (ID,ESTADOSALUD,FECHANACIMIENTO,RECETAACTIAL,IDORDEN,IDUSUARIOAFILIADO,IDEPS,IDCITA)
VALUES (0,"",DATE,"",0,0,0,0)

--CONSULTA3 

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0) 

INSERT INTO IPS (ID, IDEPS,LOCALIZACION,NOMBRE)
VALUES (0,0,"","");

--CONSULTA4

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0) 

INSERT INTO 'MEDICO' (ID,ESPECIALIDAD,NUMEROREGISTRO,FECHAVISITA,IDUSUARIO)
VALUES (0,"","",DATE,0);

--CONSULTA5

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0) 

INSERT INTO 'USUARIO' (ID,EMAIL,NOMBRE,NUMERODOCUMENTO, ROL, TIPODOCUMENTO) 
VALUES ("","","",0 ,"",""); 

INSERT INTO 'AFILIADO' (ID,ESTADOSALUD,FECHANACIMIENTO,RECETAACTIAL,IDORDEN,IDUSUARIOAFILIADO,IDEPS,IDCITA)
VALUES (0,"",DATE,"",0,0,0,0)

--CONSULTA6
--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM ADMINISTRADOR
WHERE (ID= 0) 

INSERT INTO 'SERVICIO' (ID,CAPACIDAD,NOMBRE,ESTADO,FECHA,HORARIOS,IDOREN,IDIPS,MEDICOS)
VALUES (0,0,"","",DATE,"",0,0,0)

--CONSULTA7

--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM MEDICO
WHERE (ID= 0) 

INSERT INTO 'SERVICIO' (ID,CAPACIDAD,NOMBRE,ESTADO,FECHA,HORARIOS,IDOREN,IDIPS,MEDICOS)
VALUES (0,0,"","",DATE,"",0,0,0)

--CONSULTA8
--SI ESTO NO ME ARROJA UN VALOR NULL NO PASO A LO OTRO
SELECT * 
FROM AFILIADO
WHERE (ID= 0) 

--LE MUESTRA LOS SERVICIOS DISPONIBLES DE UN TIPO Y LAS FECHAS PARA QUE EL CLIENTE QUIERA LA CITA 
SELECT NOMBRE , FECHA
FROM SERVICIO 
WHERE (NOMBRE = "EL DESEADO"  AND FECHA > ACTUAL AND FECHA MENOS  (ACTUAL+UNMES)

INSERT INTO 'CITA' (ID,ASISTIO,FECHA,IDSERVICIO,NOMBRESERVICIO)
VALUES(0,0,DATE,0,"")

--CONSULTA9



UPDATE 'CITA' 
SET ASISITIO = 1;
WHERE IDSERVICIO = 0;

--consultac1
  SELECT  IPS.NOMBRE, COUNT(SERVICIOS.ID)
   FROM (IPS INNER JOIN  SERVICIO  ON IPS.ID = SERVICIO.IDIPS)  
  WHERE (  SERVICIO.FECHA > A AND SERVICIO.FECHA < B); 

  --CONSULTAC2
   SELECT NOMBRE, COUNT(ID)
   FROM  SERVICIO 
  WHERE (  FECHA > A AND FECHA < B)
  ORDER BY COUNT(SERVICIOS) DESC
  LIMIT 20;

  --CONSULTAC3

 --CON ESTE SACO EL NUMERO PARA CADA UNO
 SELECT  IPS.NOMBRE, COUNT(SERVICIOS.ID)
   FROM (IPS INNER JOIN  SERVICIO  ON IPS.ID = SERVICIO.IDIPS)  
  WHERE (  SERVICIO.FECHA > A AND SERVICIO.FECHA < B); 

--CON ESTE EL NUMERO TOTAL DE SERVICIOS A PARTIR DE ESO SE HACEN CALCULOS
  SELECT COUNT(SERVICIOS.ID)
  FROM (IPS INNER JOIN  SERVICIO  ON IPS.ID = SERVICIO.IDIPS)  

--CONSULTAC4
SELECT * 
FROM SERVICIO 
WHERE ((FECHA > A  AND FECHA < B) OR NOMBRE CONTAINS = "" OR (COUNT(ID)>0 AND (FECHA > A  AND FECHA < B)) );

--CONSULTAC5

SELECT AFILIADO.NOMBRE, SERVICIO.ID , SERVICIO.NOMBRE 
FROM ((AFILIADO INNER JOIN CITA  ON AFILIADO.IDCITA = CITA.ID) INNER JOIN SERVICIO  ON CITA.IDSERVICIO = SERVICIO.ID)  
WHERE (CITA.ASISITIO = 1); 